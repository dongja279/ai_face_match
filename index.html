/*
최신 수정 사항 반영된 복붙용 코드
- alt=""로 변경하여 '미리보기' 텍스트 제거
- 불필요한 텍스트 스타일 수정
- 분석 상태 '100% 분석 중...' -> '분석 완료' 반영
*/

import React, { useState } from 'react';

export default function FaceMatchApp() {
  const [previewA, setPreviewA] = useState(null);
  const [previewB, setPreviewB] = useState(null);
  const [loading, setLoading] = useState(false);
  const [progress, setProgress] = useState(0);
  const [result, setResult] = useState(null);

  const handleImageUpload = (e, setPreview) => {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onloadend = () => {
        setPreview(reader.result);
      };
      reader.readAsDataURL(file);
    }
  };

  const handleAnalyze = async () => {
    setLoading(true);
    setProgress(0);

    // 진행률 애니메이션
    const interval = setInterval(() => {
      setProgress((prev) => {
        if (prev >= 100) {
          clearInterval(interval);
          return 100;
        }
        return prev + 10;
      });
    }, 200);

    // 실제 API 호출 예시
    setTimeout(() => {
      clearInterval(interval);
      setProgress(100);
      setLoading(false);
      setResult({
        love: { score: 85, good: ['서로의 감정을 잘 이해함', '소통이 원활함'], caution: ['가끔 의견 충돌 가능성', '서로의 공간 존중 필요'] },
        business: { score: 78, good: ['서로의 강점 활용', '협력 기회 많음'], caution: ['의사결정 속도 차이', '리더십 충돌 가능성'] },
        wealth: '재물운: 안정적인 흐름, 장기 투자 유리',
        health: '건강운: 체력 유지에 좋음, 규칙적인 생활 필요'
      });
    }, 3000);
  };

  return (
    <div className="app-container">
      <h1>AI 관상궁합</h1>
      <p className="subtitle">두 사람의 얼굴을 분석하여 재물·연애·건강 운과 궁합을 알려줍니다.</p>

      <div className="upload-section">
        <div className="upload-box">
          {previewA && <img src={previewA} alt="" className="preview-image" />}
          <input type="file" accept="image/*" onChange={(e) => handleImageUpload(e, setPreviewA)} />
          <button>A 사진 업로드</button>
        </div>

        <div className="upload-box">
          {previewB && <img src={previewB} alt="" className="preview-image" />}
          <input type="file" accept="image/*" onChange={(e) => handleImageUpload(e, setPreviewB)} />
          <button>B 사진 업로드</button>
        </div>
      </div>

      {loading ? (
        <div className="progress-bar">
          <div className="progress" style={{ width: `${progress}%` }}></div>
          <p>{progress < 100 ? `${progress}% 분석 중...` : '분석 완료'}</p>
        </div>
      ) : (
        <button onClick={handleAnalyze}>관상궁합 분석하기</button>
      )}

      {result && (
        <div className="result-section">
          <div className="result-card">
            <h2>💖 연애/우정 궁합 {result.love.score}점</h2>
            <h4>잘 맞는 점</h4>
            <ul>{result.love.good.map((g, i) => <li key={i}>{g}</li>)}</ul>
            <h4>조심해야 할 점</h4>
            <ul>{result.love.caution.map((c, i) => <li key={i}>{c}</li>)}</ul>
          </div>

          <div className="result-card">
            <h2>💼 비즈니스 궁합 {result.business.score}점</h2>
            <h4>잘 맞는 점</h4>
            <ul>{result.business.good.map((g, i) => <li key={i}>{g}</li>)}</ul>
            <h4>조심해야 할 점</h4>
            <ul>{result.business.caution.map((c, i) => <li key={i}>{c}</li>)}</ul>
          </div>

          <div className="result-extra">
            <p>{result.wealth}</p>
            <p>{result.health}</p>
          </div>
        </div>
      )}
    </div>
  );
}
